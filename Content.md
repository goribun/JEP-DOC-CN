一、介绍
====
1.概述
----
JEP是一个用于解析和计算数学表达式的Java类库。通过使用这个包你可以把公式看作字符串并快速计算它们。其中内置了大量公共的数学函数和常量供用户使用。另外，你也可以通过自定义变量、常量、函数等方式扩展JEP。
###  1.1特性
- 占用空间小（281kb类库）
- 快速计算
- 支持任意精度的算术
- 支持字符串、向量和复数
- 包括常用数学函数和预定义常量
- 支持布尔表达式(!, &&, ||, <, >, !=, ==, >=, and <=)
- 支持隐式乘法（允许使用“3x”代替“3*x”这种表达式）
- 支持赋值表达式（例如x=5）
- 允许选择声明变量或未声明变量
- 可扩展的自定义函数
- 可定制的语法表达式
- 兼容J2SE 5
- 支持字符编码（包括希腊符号）
- 丰富的文档
- 包括JavaCC语法

2.解析和计算
----
使用JEP计算一个字符串表达式包括两个步骤，如下图所示。首先是解析表达式，从字符串结构解析为树形结构。表达式的树形结构表示允许接下来的简单、快速的表达式计算。接下来将更详细地讨论这两个步骤。  
![image](https://github.com/time-out01/JEP-DOC-CN/blob/master/image/img01.png)
###2.1解析
一般来说，可以描述解析作为一系列字符作为输入并产生一组包含字符集合信息的结构化表示。解析虽然用于其他领域例如自然语言解析等，但是这里的重点是数学表达式。<br>
数学表达式可以通过树形结构表示，其中数字、变量、操作符和函数全部通过节点表示。数字和字符称为“子节点”，操作符和函数称为“父节点”。父节点操作它的子节点。例如，表达式“1+2*3”可以表示为一棵包含五个节点的树，如上图所示。<br>
你也许会问为什么“乘”节点是“加”节点的一个子节点。这是运算优先级的原因。当解析表达式时，需要遵守优先级的顺序。乘法的优先级高于加法的优先级。所以，如上例所示，它需要在加1之前计算2乘以3。在树中，这是由乘法操作符的子节点数字2和3组成的。最后，乘法节点自己作为加法节点的一个子节点，计算乘法的结果用于计算加法操作。解析器按照优先级顺序负责确定语法。<br>
解析器通常使用解析器生成器生成，例如JavaCC、ANTLR、SableCC、Yacc或者Bison。在众多解析器生成器中，JEP使用JavaCC。使用JccParser中定义的语法。JavaCC创建一组类来执行解析过程的核心任务。一个可配置的Java解析器也包括其中。<br>
###2.2计算
计算把表达式从一个树形表示转变为一个表达式的值。从树通过操作符优先级建立，计算方法不需要知道操作符优先级。树可以使用一个简单的方法确定表达式的值来遍历。
一个简单的方法是从树的根节点（最顶层的节点）开始，运用递归方法。这个可以使用访问者模式来实现。不同的方法可以为每个节点类型创建。计算一个操作或者一个函数节点，首先子节点要被计算。然后，用子节点的值，操作符或者函数用于确定节点本身的值。常量（数字）或者变量节点，节点计算常量或者变量的值。使用这样的递归方法迅速地通过深度优先算法遍历树。<br>

二、基本用法
====
1.入门指南
----
在你的项目中使用JEP非常简单。下面的步骤将帮助你快速开始。<br>  

1.  下载JEP包 
2.  解压包
3.  移动jep-java-x.x.x.jar文件(位于主目录)到所选择的目录中
4.  重要：当编译程序时，确保Java编译器能够找到JEP 类，它需要知道它们的位置。你需要设置IDE中jar的位置来让编译器发现类库（如何去做请查看你的IDE帮助手册），如果你不是用IDE，你需要把jar加入到你的CLASSPATH环境变量中，例如 C:\java\packages\jep-java=x.x.x.jar，这取决于你把jar放到哪一路径。
5.  将以下代码加入到你的程序中。<br>
			
			import com.singularsys.jep.Jep;
			import com.singularsys.jep.JepException;
			public class Demo {
				public static void main(String[] args) {
					Jep jep = new Jep();
					try {
			jep.addVariable("x", 10);
			jep.parse("x+1");
			Object result = jep.evaluate();
			
			System.out.println("x + 1 = " + result);
		} catch (JepException e) {
			System.out.println("An error occurred: " + e.getMessage());
		}
				}
			    }
第五行创建了一个Jep解析器对象，第七行添加一个变量“x”，并为其赋初始值“10”，第八行和第九行，解析表达式“x+1”，并计算；计算结果保存在result中；最后，打印结果。
6.  你应该能够编译运行你的应用，并看到打印值。
接下来是什么？通过浏览文档明白Jep都能做什么。也可以看下简单的示例applets。<br>

2.错误处理
----
当错误发生，异常将被解析和计算方法抛出。解析方法抛出ParseException实例，计算方法抛出EvaluationException实例。两个异常类都继承自JepException类，所以如果你不需要区分解析错误和计算错误，你可以简单地抛出JepException实例。<br>
异常类通过getMessage()方法提供关于错误发生的信息。<br>

3.默认设置
----
 如果你通过使用默认设置创建一个Jep实例，你可以解析带有以下函数列表中的函数的所以功能，你也可以使用以下常量：
 ||pi||3.1415…圆的周长比圆的直径（Math.PI）||
||e||2.718…双精度欧拉常数（Math.E）||
||true||布尔常量（Boolean.TRUE）||
||false||布尔常量（Boolean.FALSE）||
||i||虚数单位||
